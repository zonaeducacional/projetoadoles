<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plataforma de Debate e Publicação</title>
    
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827;
            color: #d1d5db;
        }
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .page {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .nav-link.active {
            background-color: #374151;
            color: #ffffff;
        }
        .admin-badge {
            font-size: 0.68rem;
            background: #4f46e5;
            color: #fff;
            padding: 2px 8px;
            border-radius: 8px;
            margin-left: 8px;
        }
        .btn-admin {
            background: #4f46e5;
            color: #fff;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.9rem;
            margin-left: 6px;
        }
        .btn-admin:hover {
            background: #3730a3;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-300">

    <div class="relative min-h-screen md:flex">
        <!-- Overlay para o menu mobile -->
        <div id="sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-20 hidden md:hidden"></div>

        <!-- Header para Mobile -->
        <div class="bg-gray-800 text-gray-100 flex justify-between md:hidden fixed top-0 left-0 right-0 z-40">
            <a href="#" class="block p-4 text-white font-bold">Projeto Adolescência</a>
            <button id="hamburger-button" class="p-4 focus:outline-none focus:bg-gray-700">
                <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                </svg>
            </button>
        </div>

        <!-- Sidebar de Navegação -->
        <aside id="sidebar" class="bg-gray-800 text-gray-200 w-64 space-y-4 p-4 flex flex-col fixed inset-y-0 left-0 transform -translate-x-full md:relative md:translate-x-0 transition-transform duration-300 ease-in-out z-30">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="bg-indigo-600 p-2 rounded-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-white"><path d="M12 22h6a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v8"></path><path d="M6 18H4a2 2 0 0 1-2-2v-2a2 2 0 0 1 2-2h2"></path><path d="M18 18h2a2 2 0 0 0 2-2v-2a2 2 0 0 0-2-2h-2"></path><path d="M6 6h12"></path><path d="M6 10h12"></path><path d="M6 14h6"></path></svg>
                    </div>
                    <h1 class="text-xl font-bold">Redação & Debate</h1>
                </div>
                <button id="close-sidebar-button" class="md:hidden p-2 focus:outline-none">
                     <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            
            <nav class="flex-1 flex flex-col space-y-2">
                <a href="#" id="nav-dashboard" class="nav-link active flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
                    Painel Principal
                </a>
                <a href="#" id="nav-laboratorio" class="nav-link flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><path d="m10.4 12.6-2.8 2.8"></path><path d="M10.4 15.4 7.6 18"></path><path d="m14 16-3 3"></path></svg>
                    Laboratório de Escrita
                </a>
                <a href="#" id="nav-mural" class="nav-link flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"></rect><line x1="3" x2="21" y1="9" y2="9"></line><line x1="9" x2="9" y1="21" y2="9"></line></svg>
                    Mural de Publicações
                </a>
                <a href="#" id="nav-biblioteca" class="nav-link flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M20 2v15"></path><path d="M4 22V4a2 2 0 0 1 2-2h14"></path></svg>
                    Biblioteca
                </a>
                <a href="#" id="nav-admin" class="nav-link flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors hidden">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="7" r="4"></circle><path d="M5.5 21h13a2 2 0 0 0 2-2v-2a7 7 0 0 0-14 0v2a2 2 0 0 0 2 2z"></path></svg>
                    Área do Professor <span class="admin-badge">Admin</span>
                </a>
            </nav>
            <div class="mt-auto pt-4 border-t border-gray-700">
                <p class="text-xs text-gray-400">Escola Januário E. de Lima - LPT</p>
            </div>
        </aside>

        <!-- Conteúdo Principal -->
        <main class="flex-1 p-6 lg:p-8 overflow-y-auto no-scrollbar pt-20 md:pt-6">
            
            <div id="dashboard-page" class="page">
                <h2 class="text-2xl md:text-3xl font-bold text-white mb-6">Painel Principal -  Projeto Didático Adolescência em Debate</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    
                    <a href="https://www.kialo-edu.com/p/c6ff308e-959a-43fa-9269-4bae8c22676f/522316" target="_blank" class="bg-gray-800 p-6 rounded-xl hover:bg-gray-700 hover:scale-105 transition-all duration-300 transform">
                        <div class="flex items-center gap-4 mb-4">
                            <div class="bg-blue-500 p-3 rounded-lg">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-white"><path d="M17 6.1H3"></path><path d="M21 12.1H3"></path><path d="M15.1 18H3"></path></svg>
                            </div>
                            <h3 class="text-xl font-bold text-white">Fórum de Debates</h3>
                        </div>
                        <p class="text-gray-400">Participe de discussões estruturadas sobre os temas do Projeto relevantes para a redação do Artigo. (Link externo)</p>
                    </a>

                    <div id="card-laboratorio" class="bg-gray-800 p-6 rounded-xl hover:bg-gray-700 hover:scale-105 transition-all duration-300 transform cursor-pointer">
                        <div class="flex items-center gap-4 mb-4">
                             <div class="bg-green-500 p-3 rounded-lg">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-white"><path d="M12 22h6a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v8"></path><path d="M6 18H4a2 2 0 0 1-2-2v-2a2 2 0 0 1 2-2h2"></path><path d="m16 14-4 4 4 4"></path><path d="m18 8-4-4-4 4"></path></svg>
                            </div>
                            <h3 class="text-xl font-bold text-white">Laboratório de Escrita</h3>
                        </div>
                        <p class="text-gray-400">Acesse materiais, aprenda a estrutura do artigo de opinião e publique seus textos.</p>
                    </div>

                    <div id="card-mural" class="bg-gray-800 p-6 rounded-xl hover:bg-gray-700 hover:scale-105 transition-all duration-300 transform cursor-pointer">
                        <div class="flex items-center gap-4 mb-4">
                             <div class="bg-purple-500 p-3 rounded-lg">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-white"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"></rect><line x1="3" x2="21" y1="9" y2="9"></line><line x1="9" x2="9" y1="21" y2="9"></line></svg>
                            </div>
                            <h3 class="text-xl font-bold text-white">Mural de Publicações</h3>
                        </div>
                        <p class="text-gray-400">Veja os artigos de opinião publicados por outros estudantes e compartilhe o seu.</p>
                    </div>
                </div>
            </div>

            <div id="laboratorio-page" class="page hidden">
                <h2 class="text-2xl md:text-3xl font-bold text-white mb-6">Laboratório de Escrita</h2>
                <div class="space-y-8">
                    <!-- ... mantém igual ... -->
                </div>
            </div>

            <div id="mural-page" class="page hidden">
                <h2 class="text-2xl md:text-3xl font-bold text-white mb-6">Mural de Publicações</h2>
                <div id="articles-container" class="space-y-4">
                    <p id="loading-message" class="text-gray-400">Carregando publicações...</p>
                </div>
            </div>

            <div id="biblioteca-page" class="page hidden">
                <h2 class="text-2xl md:text-3xl font-bold text-white mb-6">Biblioteca de Links</h2>
                <div id="biblioteca-container" class="space-y-4 mb-4"></div>
                <form id="biblioteca-form" class="space-y-3 hidden bg-gray-800 p-4 rounded-xl mb-6">
                    <div>
                        <label for="link-title" class="block text-sm font-medium text-gray-300 mb-1">Título</label>
                        <input type="text" id="link-title" name="title" required class="w-full bg-gray-700 border border-gray-600 text-white rounded-lg p-2.5">
                    </div>
                    <div>
                        <label for="link-url" class="block text-sm font-medium text-gray-300 mb-1">URL</label>
                        <input type="url" id="link-url" name="url" required class="w-full bg-gray-700 border border-gray-600 text-white rounded-lg p-2.5">
                    </div>
                    <button type="submit" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg w-full">Adicionar Link</button>
                </form>
            </div>

            <div id="admin-page" class="page hidden">
                <h2 class="text-2xl md:text-3xl font-bold text-white mb-6">Área do Professor (Admin)</h2>
                <div class="mb-6">
                    <h3 class="text-lg font-bold mb-2 text-indigo-300">Gerenciar Publicações dos Alunos</h3>
                    <div id="admin-articles-container" class="space-y-4"></div>
                </div>
                <div class="mb-6">
                    <h3 class="text-lg font-bold mb-2 text-indigo-300">Gerenciar Biblioteca</h3>
                    <div id="admin-biblioteca-container" class="space-y-2"></div>
                </div>
                <button id="logout-admin-btn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg">Sair da Área Admin</button>
            </div>

            <!-- Modal Login Admin -->
            <div id="admin-login-modal" class="fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center hidden">
                <div class="bg-gray-800 rounded-lg p-8 max-w-sm w-full shadow-lg">
                    <h2 class="text-xl font-bold mb-4 text-white">Login do Professor</h2>
                    <form id="admin-login-form" class="space-y-4">
                        <div>
                            <label for="admin-user" class="block text-gray-300 mb-1">Usuário</label>
                            <input id="admin-user" type="text" class="w-full bg-gray-700 border border-gray-600 text-white rounded-lg p-2.5" required>
                        </div>
                        <div>
                            <label for="admin-pass" class="block text-gray-300 mb-1">Senha</label>
                            <input id="admin-pass" type="password" class="w-full bg-gray-700 border border-gray-600 text-white rounded-lg p-2.5" required>
                        </div>
                        <button type="submit" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg">Entrar</button>
                    </form>
                </div>
            </div>

        </main>
    </div>
    
    <div id="notification-modal" class="hidden fixed top-20 md:top-5 right-5 bg-green-500 text-white py-3 px-5 rounded-lg shadow-lg z-50 animate-pulse">
        <p>Publicação realizada com sucesso!</p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- CONFIGURAÇÃO JSONBin ---
            // O bin de artigos é o mesmo do código original.
            const JSONBIN_API_KEY = '$2a$10$dl/5wg6j78uEQNgmToucuuah.Ez9UyMql8Un4Cpmjm4ian4j9o.7e';
            const JSONBIN_BIN_ID = '68699fe98a456b7966bbfe93';
            const JSONBIN_BIBLIOTECA_BIN = '6869aeb98a456b7966bbfe9a'; // novo bin para biblioteca

            const JSONBIN_URL = `https://api.jsonbin.io/v3/b/${JSONBIN_BIN_ID}`;
            const JSONBIN_BIBLIOTECA_URL = `https://api.jsonbin.io/v3/b/${JSONBIN_BIBLIOTECA_BIN}`;
            const JSONBIN_HEADERS = {
                'Content-Type': 'application/json',
                'X-Master-Key': JSONBIN_API_KEY
            };

            // Senha e usuário do admin (troque por algo seguro depois)
            const ADMIN_USER = 'professor';
            const ADMIN_PASS = '123456';

            // --- ELEMENTOS DA UI ---
            const sidebar = document.getElementById('sidebar');
            const sidebarOverlay = document.getElementById('sidebar-overlay');
            const hamburgerButton = document.getElementById('hamburger-button');
            const closeSidebarButton = document.getElementById('close-sidebar-button');
            const navLinks = {
                dashboard: document.getElementById('nav-dashboard'),
                laboratorio: document.getElementById('nav-laboratorio'),
                mural: document.getElementById('nav-mural'),
                biblioteca: document.getElementById('nav-biblioteca'),
                admin: document.getElementById('nav-admin')
            };
            const cardLinks = {
                laboratorio: document.getElementById('card-laboratorio'),
                mural: document.getElementById('card-mural')
            };
            const pages = {
                dashboard: document.getElementById('dashboard-page'),
                laboratorio: document.getElementById('laboratorio-page'),
                mural: document.getElementById('mural-page'),
                biblioteca: document.getElementById('biblioteca-page'),
                admin: document.getElementById('admin-page')
            };
            const articleForm = document.getElementById('article-form');
            const articlesContainer = document.getElementById('articles-container');
            const notificationModal = document.getElementById('notification-modal');
            const bibliotecaForm = document.getElementById('biblioteca-form');
            const bibliotecaContainer = document.getElementById('biblioteca-container');
            const adminLoginModal = document.getElementById('admin-login-modal');
            const adminLoginForm = document.getElementById('admin-login-form');
            const adminArticlesContainer = document.getElementById('admin-articles-container');
            const adminBibliotecaContainer = document.getElementById('admin-biblioteca-container');
            const logoutAdminBtn = document.getElementById('logout-admin-btn');
            // --- Estado ---
            let isAdmin = false;
            let artigosGlobal = [];
            let bibliotecaGlobal = [];

            // --- LÓGICA DO MENU RESPONSIVO ---
            function toggleSidebar() {
                sidebar.classList.toggle('-translate-x-full');
                sidebarOverlay.classList.toggle('hidden');
            }
            hamburgerButton.addEventListener('click', toggleSidebar);
            closeSidebarButton.addEventListener('click', toggleSidebar);
            sidebarOverlay.addEventListener('click', toggleSidebar);

            // --- NAVEGAÇÃO ENTRE PÁGINAS ---
            function showPage(pageName) {
                Object.values(pages).forEach(page => page.classList.add('hidden'));
                Object.values(navLinks).forEach(link => link.classList.remove('active'));

                if (pages[pageName] && navLinks[pageName]) {
                    pages[pageName].classList.remove('hidden');
                    navLinks[pageName].classList.add('active');
                } else if (pages[pageName]) {
                    pages[pageName].classList.remove('hidden');
                }
                if (window.innerWidth < 768) { 
                    toggleSidebar();
                }
            }
            Object.keys(navLinks).forEach(key => {
                navLinks[key].addEventListener('click', (e) => {
                    e.preventDefault();
                    if (key === 'mural') loadArticles();
                    if (key === 'biblioteca') loadBiblioteca();
                    if (key === 'admin') showAdminLogin();
                    else showPage(key);
                });
            });
            cardLinks.laboratorio.addEventListener('click', () => showPage('laboratorio'));
            cardLinks.mural.addEventListener('click', () => {
                showPage('mural');
                loadArticles();
            });

            // --- LOGIN ADMIN ---
            function showAdminLogin() {
                if (isAdmin) {
                    showPage('admin');
                    loadAdminPanel();
                } else {
                    adminLoginModal.classList.remove('hidden');
                }
            }
            adminLoginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const user = document.getElementById('admin-user').value.trim();
                const pass = document.getElementById('admin-pass').value.trim();
                if (user === ADMIN_USER && pass === ADMIN_PASS) {
                    isAdmin = true;
                    navLinks.admin.classList.remove('hidden');
                    adminLoginModal.classList.add('hidden');
                    showPage('admin');
                    loadAdminPanel();
                    bibliotecaForm.classList.remove('hidden');
                } else {
                    alert('Usuário ou senha incorretos.');
                }
                adminLoginForm.reset();
            });
            logoutAdminBtn.addEventListener('click', () => {
                isAdmin = false;
                showPage('dashboard');
                navLinks.admin.classList.add('hidden');
                bibliotecaForm.classList.add('hidden');
            });

            // --- LÓGICA DO JSONBin (MURAL) ---
            function renderArticles(articles) {
                articlesContainer.innerHTML = '';
                if (!articles || articles.length === 0) {
                    articlesContainer.innerHTML = '<p class="text-gray-400">Ainda não há publicações. Seja o primeiro a compartilhar seu artigo!</p>';
                    return;
                }
                const sortedArticles = articles.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
                sortedArticles.forEach(article => {
                    const articleElement = document.createElement('a');
                    articleElement.href = article.url;
                    articleElement.target = '_blank';
                    articleElement.rel = 'noopener noreferrer';
                    articleElement.className = 'block bg-gray-800 p-4 rounded-lg hover:bg-gray-700 transition-colors';

                    const titleElement = document.createElement('h4');
                    titleElement.textContent = article.title;
                    titleElement.className = 'text-lg font-bold text-indigo-400';

                    const authorElement = document.createElement('p');
                    authorElement.textContent = `Por: ${article.author}`;
                    authorElement.className = 'text-sm text-gray-400';
                    
                    const urlElement = document.createElement('p');
                    urlElement.textContent = article.url;
                    urlElement.className = 'text-xs text-gray-500 mt-2 truncate';

                    articleElement.appendChild(titleElement);
                    articleElement.appendChild(authorElement);
                    articleElement.appendChild(urlElement);
                    articlesContainer.appendChild(articleElement);
                });
            }
            async function loadArticles() {
                document.getElementById('loading-message').style.display = 'block';
                try {
                    const response = await fetch(`${JSONBIN_URL}/latest`, {
                        method: 'GET',
                        headers: { 'X-Master-Key': JSONBIN_API_KEY }
                    });
                    if (response.status === 404) {
                         renderArticles([]);
                         return;
                    }
                    if (!response.ok) throw new Error(`Erro de rede: ${response.statusText}`);
                    const data = await response.json();
                    artigosGlobal = data.record || [];
                    renderArticles(artigosGlobal);
                } catch (error) {
                    articlesContainer.innerHTML = '<p class="text-red-400">Ocorreu um erro ao carregar as publicações.</p>';
                } finally {
                    document.getElementById('loading-message').style.display = 'none';
                }
            }

            // --- LÓGICA DO FORMULÁRIO DE PUBLICAÇÃO ---
            articleForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const title = articleForm.title.value;
                const author = articleForm.author.value;
                const url = articleForm.url.value;
                const newArticle = { title, author, url, createdAt: new Date().toISOString(), avaliacao: null };

                const submitButton = articleForm.querySelector('button[type="submit"]');
                submitButton.disabled = true;
                submitButton.textContent = 'Publicando...';

                try {
                    const getResponse = await fetch(`${JSONBIN_URL}/latest`, { headers: { 'X-Master-Key': JSONBIN_API_KEY } });
                    let articles = [];
                    if (getResponse.ok) {
                        const currentData = await getResponse.json();
                        articles = Array.isArray(currentData.record) ? currentData.record : [];
                    } else if (getResponse.status !== 404) {
                        throw new Error('Não foi possível buscar os artigos existentes.');
                    }
                    articles.push(newArticle);
                    const putResponse = await fetch(JSONBIN_URL, {
                        method: 'PUT',
                        headers: JSONBIN_HEADERS,
                        body: JSON.stringify(articles)
                    });
                    if (!putResponse.ok) throw new Error('Não foi possível salvar o novo artigo.');
                    articleForm.reset();
                    showNotification();
                    showPage('mural');
                    renderArticles(articles);
                } catch (error) {
                    alert("Ocorreu um erro ao publicar seu artigo: " + error.message);
                } finally {
                    submitButton.disabled = false;
                    submitButton.textContent = 'Publicar no Mural';
                }
            });

            // --- FUNÇÕES DA ÁREA ADMIN ---
            async function loadAdminPanel() {
                await loadArticles();
                await loadBiblioteca();
                renderAdminArticles(artigosGlobal);
                renderAdminBiblioteca(bibliotecaGlobal);
            }
            function renderAdminArticles(articles) {
                adminArticlesContainer.innerHTML = '';
                if (!articles || articles.length === 0) {
                    adminArticlesContainer.innerHTML = '<p class="text-gray-400">Nenhuma publicação encontrada.</p>';
                    return;
                }
                articles.forEach((article, i) => {
                    const div = document.createElement('div');
                    div.className = 'bg-gray-700 p-4 rounded-lg flex flex-col md:flex-row md:items-center justify-between gap-2';
                    div.innerHTML = `
                        <div>
                            <h4 class="font-bold text-indigo-300">${article.title}</h4>
                            <p class="text-sm text-gray-300">Por: ${article.author}</p>
                            <a href="${article.url}" target="_blank" class="text-xs text-indigo-400 hover:underline">${article.url}</a>
                            <span class="ml-2 text-xs text-gray-300">${article.createdAt ? (new Date(article.createdAt)).toLocaleString('pt-BR') : ''}</span>
                            <span id="admin-avaliacao-${i}" class="ml-2 text-sm font-semibold">${article.avaliacao ? 'Nota: ' + article.avaliacao : ''}</span>
                        </div>
                        <div class="flex gap-2 flex-wrap">
                            <button class="btn-admin" onclick="editarArtigo(${i})">Editar</button>
                            <button class="btn-admin" onclick="excluirArtigo(${i})">Excluir</button>
                            <input type="number" min="0" max="10" step="0.5" placeholder="Nota" style="width:60px;border-radius:5px;padding:2px" id="input-nota-${i}">
                            <button class="btn-admin" onclick="avaliarArtigo(${i})">Avaliar</button>
                        </div>
                    `;
                    adminArticlesContainer.appendChild(div);
                });
            }
            window.editarArtigo = async function(idx) {
                const artigo = artigosGlobal[idx];
                const novoTitulo = prompt('Editar título:', artigo.title);
                if (novoTitulo !== null) artigo.title = novoTitulo;
                const novoAutor = prompt('Editar autor:', artigo.author);
                if (novoAutor !== null) artigo.author = novoAutor;
                const novaUrl = prompt('Editar URL:', artigo.url);
                if (novaUrl !== null) artigo.url = novaUrl;
                await salvarArtigos();
            };
            window.excluirArtigo = async function(idx) {
                if (confirm('Tem certeza que deseja excluir esta publicação?')) {
                    artigosGlobal.splice(idx, 1);
                    await salvarArtigos();
                }
            };
            window.avaliarArtigo = async function(idx) {
                const notaInput = document.getElementById('input-nota-'+idx);
                const nota = notaInput.value.trim();
                if (nota === '' || isNaN(nota) || nota < 0 || nota > 10) {
                    alert('Digite uma nota válida entre 0 e 10');
                    return;
                }
                artigosGlobal[idx].avaliacao = nota;
                await salvarArtigos();
            };
            async function salvarArtigos() {
                try {
                    await fetch(JSONBIN_URL, {
                        method: 'PUT',
                        headers: JSONBIN_HEADERS,
                        body: JSON.stringify(artigosGlobal)
                    });
                    renderAdminArticles(artigosGlobal);
                    renderArticles(artigosGlobal);
                } catch {
                    alert('Erro ao salvar dados.');
                }
            }

            // --- BIBLIOTECA (links) ---
            async function loadBiblioteca() {
                try {
                    const response = await fetch(`${JSONBIN_BIBLIOTECA_URL}/latest`, {
                        method: 'GET',
                        headers: { 'X-Master-Key': JSONBIN_API_KEY }
                    });
                    if (!response.ok) throw new Error();
                    const data = await response.json();
                    bibliotecaGlobal = data.record || [];
                    renderBiblioteca(bibliotecaGlobal);
                } catch {
                    bibliotecaGlobal = [];
                    renderBiblioteca([]);
                }
            }
            function renderBiblioteca(lista) {
                bibliotecaContainer.innerHTML = '';
                if (!lista || lista.length === 0) {
                    bibliotecaContainer.innerHTML = '<p class="text-gray-400">Nenhum link disponível. Professores podem adicionar recursos na área admin.</p>';
                    return;
                }
                lista.forEach(link => {
                    const a = document.createElement('a');
                    a.href = link.url;
                    a.target = '_blank';
                    a.className = "block bg-gray-800 p-3 rounded-lg hover:bg-gray-700 mb-2 transition-colors";
                    a.innerHTML = `<span class="text-indigo-300 font-bold">${link.title}</span><br>
                                   <span class="text-xs text-gray-400">${link.url}</span>`;
                    bibliotecaContainer.appendChild(a);
                });
            }
            function renderAdminBiblioteca(lista) {
                adminBibliotecaContainer.innerHTML = '';
                if (!lista || lista.length === 0) {
                    adminBibliotecaContainer.innerHTML = '<p class="text-gray-400">Nenhum link cadastrado.</p>';
                    return;
                }
                lista.forEach((link, i) => {
                    const div = document.createElement('div');
                    div.className = "flex items-center justify-between bg-gray-700 p-2 rounded mb-1";
                    div.innerHTML = `
                        <a href="${link.url}" target="_blank" class="text-indigo-300">${link.title}</a>
                        <div>
                            <button class="btn-admin" onclick="editarLink(${i})">Editar</button>
                            <button class="btn-admin" onclick="excluirLink(${i})">Excluir</button>
                        </div>
                    `;
                    adminBibliotecaContainer.appendChild(div);
                });
            }
            bibliotecaForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const title = bibliotecaForm.title.value;
                const url = bibliotecaForm.url.value;
                bibliotecaGlobal.push({ title, url });
                await salvarBiblioteca();
                bibliotecaForm.reset();
            });
            window.editarLink = async function(idx) {
                const link = bibliotecaGlobal[idx];
                const novoTitulo = prompt('Editar título:', link.title);
                if (novoTitulo !== null) link.title = novoTitulo;
                const novaUrl = prompt('Editar URL:', link.url);
                if (novaUrl !== null) link.url = novaUrl;
                await salvarBiblioteca();
            };
            window.excluirLink = async function(idx) {
                if (confirm('Excluir este link?')) {
                    bibliotecaGlobal.splice(idx, 1);
                    await salvarBiblioteca();
                }
            };
            async function salvarBiblioteca() {
                try {
                    await fetch(JSONBIN_BIBLIOTECA_URL, {
                        method: 'PUT',
                        headers: JSONBIN_HEADERS,
                        body: JSON.stringify(bibliotecaGlobal)
                    });
                    renderAdminBiblioteca(bibliotecaGlobal);
                    renderBiblioteca(bibliotecaGlobal);
                } catch {
                    alert('Erro ao salvar biblioteca.');
                }
            }

            // --- FUNÇÕES AUXILIARES ---
            function showNotification() {
                notificationModal.classList.remove('hidden');
                setTimeout(() => {
                    notificationModal.classList.add('hidden');
                }, 3000);
            }

            // --- INICIALIZAÇÃO DA APLICAÇÃO ---
            showPage('dashboard');
            // Carrega os artigos na primeira vez que a página do mural é mostrada
            if (!pages.mural.classList.contains('hidden')) loadArticles();
            // Esconde área admin e formulário biblioteca para alunos
            navLinks.admin.classList.add('hidden');
            bibliotecaForm.classList.add('hidden');
        });
    </script>
</body>
</html>
